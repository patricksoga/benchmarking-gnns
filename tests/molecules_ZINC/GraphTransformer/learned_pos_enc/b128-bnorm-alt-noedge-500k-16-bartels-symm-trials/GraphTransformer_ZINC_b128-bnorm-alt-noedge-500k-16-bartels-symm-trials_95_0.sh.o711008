[I] Loading dataset ZINC, fold 1...
train, test, val sizes : 10000 1000 1000
[I] Finished loading.
[I] Data load time: 10.4630s
0it [00:00, ?it/s]/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py:319: UserWarning: Casting complex values to real discards the imaginary part (Triggered internally at  /opt/conda/conda-bld/pytorch_1656352645774/work/aten/src/ATen/native/Copy.cpp:250.)
  pe = pe.transpose(1, 0).type(torch.float32)
1it [00:03,  3.74s/it]2it [00:04,  2.14s/it]3it [00:05,  1.63s/it]4it [00:06,  1.42s/it]5it [00:07,  1.28s/it]6it [00:08,  1.19s/it]7it [00:09,  1.15s/it]8it [00:11,  1.14s/it]9it [00:12,  1.12s/it]10it [00:13,  1.08s/it]11it [00:14,  1.06s/it]12it [00:15,  1.06s/it]13it [00:16,  1.06s/it]14it [00:17,  1.05s/it]15it [00:18,  1.06s/it]16it [00:19,  1.08s/it]17it [00:20,  1.09s/it]18it [00:21,  1.09s/it]19it [00:22,  1.11s/it]20it [00:24,  1.12s/it]21it [00:25,  1.14s/it]22it [00:26,  1.12s/it]23it [00:27,  1.10s/it]24it [00:28,  1.11s/it]25it [00:29,  1.11s/it]26it [00:30,  1.10s/it]27it [00:31,  1.10s/it]28it [00:32,  1.10s/it]29it [00:33,  1.09s/it]30it [00:35,  1.11s/it]31it [00:36,  1.11s/it]32it [00:37,  1.11s/it]33it [00:38,  1.10s/it]34it [00:39,  1.08s/it]35it [00:40,  1.08s/it]36it [00:41,  1.10s/it]37it [00:42,  1.09s/it]38it [00:43,  1.09s/it]39it [00:44,  1.08s/it]40it [00:45,  1.08s/it]41it [00:47,  1.08s/it]42it [00:48,  1.08s/it]43it [00:49,  1.08s/it]44it [00:50,  1.09s/it]45it [00:51,  1.09s/it]46it [00:52,  1.08s/it]47it [00:53,  1.09s/it]48it [00:54,  1.11s/it]49it [00:55,  1.08s/it]50it [00:56,  1.08s/it]51it [00:57,  1.07s/it]52it [00:58,  1.07s/it]53it [01:00,  1.07s/it]54it [01:01,  1.07s/it]55it [01:02,  1.08s/it]56it [01:03,  1.13s/it]57it [01:04,  1.11s/it]58it [01:05,  1.09s/it]59it [01:06,  1.09s/it]60it [01:07,  1.08s/it]61it [01:08,  1.09s/it]62it [01:09,  1.10s/it]63it [01:10,  1.08s/it]64it [01:12,  1.07s/it]65it [01:13,  1.08s/it]66it [01:14,  1.09s/it]67it [01:15,  1.12s/it]68it [01:16,  1.12s/it]69it [01:17,  1.11s/it]70it [01:18,  1.10s/it]71it [01:19,  1.10s/it]72it [01:20,  1.08s/it]73it [01:21,  1.08s/it]74it [01:22,  1.07s/it]75it [01:24,  1.09s/it]76it [01:25,  1.08s/it]77it [01:26,  1.10s/it]78it [01:27,  1.09s/it]79it [01:27,  1.24it/s]79it [01:27,  1.11s/it]
0it [00:00, ?it/s]1it [00:01,  1.03s/it]2it [00:02,  1.08s/it]3it [00:03,  1.06s/it]3it [00:05,  1.73s/it]
Traceback (most recent call last):
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/train/train_molecules_graph_regression.py", line 57, in train_epoch_sparse
    batch_scores = model.forward(batch_graphs, batch_x, batch_e)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/nets/molecules_graph_regression/graph_transformer.py", line 56, in forward
    pe = self.pe_layer(g, h, pos_enc)
  File "/afs/crc.nd.edu/user/p/psoga/.conda/envs/gnn/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 339, in forward
    return self.learned_forward(g, graph_spectra)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 316, in learned_forward
    pe = self.sylvester(transition_inverse, -mat, mat_product)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 292, in sylvester
    X = U[...,:n,:n] @ Y[...,:n,:m] @ torch.linalg.inv(V)[...,:m,:m]
torch._C._LinAlgError: torch.linalg.inv: The diagonal element 994 is zero, the inversion could not be completed because the input matrix is singular.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_molecules_graph_regression.py", line 373, in <module>
    main()    
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_molecules_graph_regression.py", line 371, in main
    train_val_pipeline(MODEL_NAME, dataset, params, net_params, dirs, params['save_name'])
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_molecules_graph_regression.py", line 165, in train_val_pipeline
    epoch_train_loss, epoch_train_mae, optimizer = train_epoch(model, optimizer, device, train_loader, epoch, MODEL_NAME, net_params)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/train/train_molecules_graph_regression.py", line 63, in train_epoch_sparse
    batch_scores = model.forward(batch_graphs, batch_x, batch_e)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/nets/molecules_graph_regression/graph_transformer.py", line 56, in forward
    pe = self.pe_layer(g, h, pos_enc)
  File "/afs/crc.nd.edu/user/p/psoga/.conda/envs/gnn/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 339, in forward
    return self.learned_forward(g, graph_spectra)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 316, in learned_forward
    pe = self.sylvester(transition_inverse, -mat, mat_product)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 292, in sylvester
    X = U[...,:n,:n] @ Y[...,:n,:m] @ torch.linalg.inv(V)[...,:m,:m]
torch._C._LinAlgError: torch.linalg.inv: The diagonal element 994 is zero, the inversion could not be completed because the input matrix is singular.
