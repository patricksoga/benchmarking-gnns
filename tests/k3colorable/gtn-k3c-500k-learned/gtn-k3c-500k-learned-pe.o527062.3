/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py:386: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  num_classes = len(np.unique(np.array(dataset.train[:][1])))
/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py:386: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  num_classes = len(np.unique(np.array(dataset.train[:][1])))
cuda available with GPU: NVIDIA GeForce GTX 1080 Ti
[I] Loading dataset K3Colorable...
train, test, val sizes : 7000 1500 1500
[I] Finished loading.
[I] Data load time: 6.7916s
MODEL DETAILS:

MODEL/Total parameters: GraphTransformer 562662
Using learned positional encoding
Training Graphs:  7000
Validation Graphs:  1500
Test Graphs:  1500
Number of Classes:  2
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1000 [50:57<?, ?it/s, lr=0.0005, test_acc=0.517, time=3.06e+3, train_acc=0.501, train_loss=0.708, val_acc=0.494, val_loss=0.695]Epoch 0:   0%|          | 1/1000 [50:57<848:28:18, 3057.56s/it, lr=0.0005, test_acc=0.517, time=3.06e+3, train_acc=0.501, train_loss=0.708, val_acc=0.494, val_loss=0.695]Epoch 1:   0%|          | 1/1000 [50:57<848:28:18, 3057.56s/it, lr=0.0005, test_acc=0.517, time=3.06e+3, train_acc=0.501, train_loss=0.708, val_acc=0.494, val_loss=0.695]Epoch 1:   0%|          | 1/1000 [1:41:51<848:28:18, 3057.56s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.51, train_loss=0.697, val_acc=0.497, val_loss=0.694]Epoch 1:   0%|          | 2/1000 [1:41:51<846:58:55, 3055.25s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.51, train_loss=0.697, val_acc=0.497, val_loss=0.694]Epoch 2:   0%|          | 2/1000 [1:41:51<846:58:55, 3055.25s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.51, train_loss=0.697, val_acc=0.497, val_loss=0.694]Epoch 2:   0%|          | 2/1000 [2:32:41<846:58:55, 3055.25s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 2:   0%|          | 3/1000 [2:32:41<845:32:22, 3053.10s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 3:   0%|          | 3/1000 [2:32:41<845:32:22, 3053.10s/it, lr=0.0005, test_acc=0.515, time=3.05e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 3:   0%|          | 3/1000 [3:23:19<845:32:22, 3053.10s/it, lr=0.0005, test_acc=0.513, time=3.04e+3, train_acc=0.501, train_loss=0.693, val_acc=0.495, val_loss=0.693]Epoch 3:   0%|          | 4/1000 [3:23:19<843:04:11, 3047.24s/it, lr=0.0005, test_acc=0.513, time=3.04e+3, train_acc=0.501, train_loss=0.693, val_acc=0.495, val_loss=0.693]Epoch 4:   0%|          | 4/1000 [3:23:19<843:04:11, 3047.24s/it, lr=0.0005, test_acc=0.513, time=3.04e+3, train_acc=0.501, train_loss=0.693, val_acc=0.495, val_loss=0.693]Epoch 4:   0%|          | 4/1000 [4:14:02<843:04:11, 3047.24s/it, lr=0.0005, test_acc=0.518, time=3.04e+3, train_acc=0.497, train_loss=0.693, val_acc=0.499, val_loss=0.693]Epoch 4:   0%|          | 5/1000 [4:14:02<841:47:04, 3045.65s/it, lr=0.0005, test_acc=0.518, time=3.04e+3, train_acc=0.497, train_loss=0.693, val_acc=0.499, val_loss=0.693]Epoch 5:   0%|          | 5/1000 [4:14:02<841:47:04, 3045.65s/it, lr=0.0005, test_acc=0.518, time=3.04e+3, train_acc=0.497, train_loss=0.693, val_acc=0.499, val_loss=0.693]Epoch 5:   0%|          | 5/1000 [5:04:48<841:47:04, 3045.65s/it, lr=0.0005, test_acc=0.484, time=3.05e+3, train_acc=0.51, train_loss=0.698, val_acc=0.497, val_loss=0.695] Epoch 5:   1%|          | 6/1000 [5:04:48<840:55:48, 3045.62s/it, lr=0.0005, test_acc=0.484, time=3.05e+3, train_acc=0.51, train_loss=0.698, val_acc=0.497, val_loss=0.695]Epoch 6:   1%|          | 6/1000 [5:04:48<840:55:48, 3045.62s/it, lr=0.0005, test_acc=0.484, time=3.05e+3, train_acc=0.51, train_loss=0.698, val_acc=0.497, val_loss=0.695]Epoch 6:   1%|          | 6/1000 [5:55:36<840:55:48, 3045.62s/it, lr=0.0005, test_acc=0.488, time=3.05e+3, train_acc=0.507, train_loss=0.693, val_acc=0.501, val_loss=0.69]Epoch 6:   1%|          | 7/1000 [5:55:36<840:18:38, 3046.44s/it, lr=0.0005, test_acc=0.488, time=3.05e+3, train_acc=0.507, train_loss=0.693, val_acc=0.501, val_loss=0.69]Epoch 7:   1%|          | 7/1000 [5:55:36<840:18:38, 3046.44s/it, lr=0.0005, test_acc=0.488, time=3.05e+3, train_acc=0.507, train_loss=0.693, val_acc=0.501, val_loss=0.69]Epoch 7:   1%|          | 7/1000 [6:46:22<840:18:38, 3046.44s/it, lr=0.0005, test_acc=0.535, time=3.05e+3, train_acc=0.538, train_loss=0.689, val_acc=0.533, val_loss=0.688]Epoch 7:   1%|          | 8/1000 [6:46:22<839:25:43, 3046.31s/it, lr=0.0005, test_acc=0.535, time=3.05e+3, train_acc=0.538, train_loss=0.689, val_acc=0.533, val_loss=0.688]Epoch 8:   1%|          | 8/1000 [6:46:22<839:25:43, 3046.31s/it, lr=0.0005, test_acc=0.535, time=3.05e+3, train_acc=0.538, train_loss=0.689, val_acc=0.533, val_loss=0.688]Epoch 8:   1%|          | 8/1000 [7:37:05<839:25:43, 3046.31s/it, lr=0.0005, test_acc=0.529, time=3.04e+3, train_acc=0.535, train_loss=0.689, val_acc=0.523, val_loss=0.692]Epoch 8:   1%|          | 9/1000 [7:37:05<838:19:40, 3045.39s/it, lr=0.0005, test_acc=0.529, time=3.04e+3, train_acc=0.535, train_loss=0.689, val_acc=0.523, val_loss=0.692]Epoch 9:   1%|          | 9/1000 [7:37:05<838:19:40, 3045.39s/it, lr=0.0005, test_acc=0.529, time=3.04e+3, train_acc=0.535, train_loss=0.689, val_acc=0.523, val_loss=0.692]Epoch 9:   1%|          | 9/1000 [8:27:42<838:19:40, 3045.39s/it, lr=0.0005, test_acc=0.535, time=3.04e+3, train_acc=0.535, train_loss=0.688, val_acc=0.533, val_loss=0.688]Epoch 9:   1%|          | 10/1000 [8:27:42<836:43:19, 3042.63s/it, lr=0.0005, test_acc=0.535, time=3.04e+3, train_acc=0.535, train_loss=0.688, val_acc=0.533, val_loss=0.688]Epoch 10:   1%|          | 10/1000 [8:27:42<836:43:19, 3042.63s/it, lr=0.0005, test_acc=0.535, time=3.04e+3, train_acc=0.535, train_loss=0.688, val_acc=0.533, val_loss=0.688]Epoch 10:   1%|          | 10/1000 [9:18:28<836:43:19, 3042.63s/it, lr=0.0005, test_acc=0.486, time=3.05e+3, train_acc=0.54, train_loss=0.689, val_acc=0.501, val_loss=0.724] Epoch 10:   1%|          | 11/1000 [9:18:28<836:08:04, 3043.56s/it, lr=0.0005, test_acc=0.486, time=3.05e+3, train_acc=0.54, train_loss=0.689, val_acc=0.501, val_loss=0.724]Epoch 11:   1%|          | 11/1000 [9:18:28<836:08:04, 3043.56s/it, lr=0.0005, test_acc=0.486, time=3.05e+3, train_acc=0.54, train_loss=0.689, val_acc=0.501, val_loss=0.724]Epoch 11:   1%|          | 11/1000 [10:09:16<836:08:04, 3043.56s/it, lr=0.0005, test_acc=0.536, time=3.05e+3, train_acc=0.541, train_loss=0.689, val_acc=0.534, val_loss=0.689]Epoch 11:   1%|          | 12/1000 [10:09:16<835:42:38, 3045.10s/it, lr=0.0005, test_acc=0.536, time=3.05e+3, train_acc=0.541, train_loss=0.689, val_acc=0.534, val_loss=0.689]Epoch 12:   1%|          | 12/1000 [10:09:16<835:42:38, 3045.10s/it, lr=0.0005, test_acc=0.536, time=3.05e+3, train_acc=0.541, train_loss=0.689, val_acc=0.534, val_loss=0.689]Epoch 12:   1%|          | 12/1000 [10:59:43<835:42:38, 3045.10s/it, lr=0.0005, test_acc=0.525, time=3.03e+3, train_acc=0.526, train_loss=0.69, val_acc=0.503, val_loss=0.694] Epoch 12:   1%|▏         | 13/1000 [10:59:43<833:22:40, 3039.68s/it, lr=0.0005, test_acc=0.525, time=3.03e+3, train_acc=0.526, train_loss=0.69, val_acc=0.503, val_loss=0.694]Epoch 13:   1%|▏         | 13/1000 [10:59:43<833:22:40, 3039.68s/it, lr=0.0005, test_acc=0.525, time=3.03e+3, train_acc=0.526, train_loss=0.69, val_acc=0.503, val_loss=0.694]Epoch 13:   1%|▏         | 13/1000 [11:49:44<833:22:40, 3039.68s/it, lr=0.0005, test_acc=0.515, time=3e+3, train_acc=0.509, train_loss=0.693, val_acc=0.501, val_loss=0.69]   Epoch 13:   1%|▏         | 14/1000 [11:49:44<829:16:56, 3027.81s/it, lr=0.0005, test_acc=0.515, time=3e+3, train_acc=0.509, train_loss=0.693, val_acc=0.501, val_loss=0.69]Epoch 14:   1%|▏         | 14/1000 [11:49:44<829:16:56, 3027.81s/it, lr=0.0005, test_acc=0.515, time=3e+3, train_acc=0.509, train_loss=0.693, val_acc=0.501, val_loss=0.69]Epoch 14:   1%|▏         | 14/1000 [12:39:43<829:16:56, 3027.81s/it, lr=0.0005, test_acc=0.524, time=3e+3, train_acc=0.505, train_loss=0.693, val_acc=0.507, val_loss=0.69]Epoch 14:   2%|▏         | 15/1000 [12:39:43<826:06:56, 3019.31s/it, lr=0.0005, test_acc=0.524, time=3e+3, train_acc=0.505, train_loss=0.693, val_acc=0.507, val_loss=0.69]Epoch 15:   2%|▏         | 15/1000 [12:39:43<826:06:56, 3019.31s/it, lr=0.0005, test_acc=0.524, time=3e+3, train_acc=0.505, train_loss=0.693, val_acc=0.507, val_loss=0.69]Epoch 15:   2%|▏         | 15/1000 [13:29:36<826:06:56, 3019.31s/it, lr=0.0005, test_acc=0.524, time=2.99e+3, train_acc=0.512, train_loss=0.692, val_acc=0.504, val_loss=0.691]Epoch 15:   2%|▏         | 16/1000 [13:29:36<823:04:18, 3011.24s/it, lr=0.0005, test_acc=0.524, time=2.99e+3, train_acc=0.512, train_loss=0.692, val_acc=0.504, val_loss=0.691]Epoch 16:   2%|▏         | 16/1000 [13:29:36<823:04:18, 3011.24s/it, lr=0.0005, test_acc=0.524, time=2.99e+3, train_acc=0.512, train_loss=0.692, val_acc=0.504, val_loss=0.691]Epoch 16:   2%|▏         | 16/1000 [14:19:25<823:04:18, 3011.24s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.505, train_loss=0.692, val_acc=0.499, val_loss=0.699]Epoch 16:   2%|▏         | 17/1000 [14:19:25<820:27:35, 3004.74s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.505, train_loss=0.692, val_acc=0.499, val_loss=0.699]Epoch 17:   2%|▏         | 17/1000 [14:19:25<820:27:35, 3004.74s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.505, train_loss=0.692, val_acc=0.499, val_loss=0.699]Epoch 17:   2%|▏         | 17/1000 [15:09:18<820:27:35, 3004.74s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.502, train_loss=0.691, val_acc=0.499, val_loss=0.694]Epoch 17:   2%|▏         | 18/1000 [15:09:18<818:37:34, 3001.07s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.502, train_loss=0.691, val_acc=0.499, val_loss=0.694]Epoch 18:   2%|▏         | 18/1000 [15:09:18<818:37:34, 3001.07s/it, lr=0.0005, test_acc=0.514, time=2.99e+3, train_acc=0.502, train_loss=0.691, val_acc=0.499, val_loss=0.694]Epoch 18:   2%|▏         | 18/1000 [15:59:14<818:37:34, 3001.07s/it, lr=0.0005, test_acc=0.523, time=3e+3, train_acc=0.512, train_loss=0.691, val_acc=0.506, val_loss=0.692]   Epoch 18:   2%|▏         | 19/1000 [15:59:14<817:24:06, 2999.64s/it, lr=0.0005, test_acc=0.523, time=3e+3, train_acc=0.512, train_loss=0.691, val_acc=0.506, val_loss=0.692]Epoch 19:   2%|▏         | 19/1000 [15:59:14<817:24:06, 2999.64s/it, lr=0.0005, test_acc=0.523, time=3e+3, train_acc=0.512, train_loss=0.691, val_acc=0.506, val_loss=0.692]Epoch 19:   2%|▏         | 19/1000 [16:49:10<817:24:06, 2999.64s/it, lr=0.0005, test_acc=0.525, time=3e+3, train_acc=0.508, train_loss=0.692, val_acc=0.509, val_loss=0.699]Epoch 19:   2%|▏         | 20/1000 [16:49:10<816:13:23, 2998.37s/it, lr=0.0005, test_acc=0.525, time=3e+3, train_acc=0.508, train_loss=0.692, val_acc=0.509, val_loss=0.699]Epoch 20:   2%|▏         | 20/1000 [16:49:10<816:13:23, 2998.37s/it, lr=0.0005, test_acc=0.525, time=3e+3, train_acc=0.508, train_loss=0.692, val_acc=0.509, val_loss=0.699]Epoch 20:   2%|▏         | 20/1000 [17:39:46<816:13:23, 2998.37s/it, lr=0.0005, test_acc=0.515, time=3.04e+3, train_acc=0.511, train_loss=0.693, val_acc=0.497, val_loss=0.692]Epoch 20:   2%|▏         | 21/1000 [17:39:46<818:30:39, 3009.85s/it, lr=0.0005, test_acc=0.515, time=3.04e+3, train_acc=0.511, train_loss=0.693, val_acc=0.497, val_loss=0.692]Epoch 21:   2%|▏         | 21/1000 [17:39:46<818:30:39, 3009.85s/it, lr=0.0005, test_acc=0.515, time=3.04e+3, train_acc=0.511, train_loss=0.693, val_acc=0.497, val_loss=0.692]Epoch 21:   2%|▏         | 21/1000 [18:30:26<818:30:39, 3009.85s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 21:   2%|▏         | 22/1000 [18:30:26<820:07:33, 3018.87s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 22:   2%|▏         | 22/1000 [18:30:26<820:07:33, 3018.87s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 22:   2%|▏         | 22/1000 [19:21:08<820:07:33, 3018.87s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.696]Epoch 22:   2%|▏         | 23/1000 [19:21:08<821:08:52, 3025.72s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.696]Epoch 23:   2%|▏         | 23/1000 [19:21:08<821:08:52, 3025.72s/it, lr=0.00025, test_acc=0.515, time=3.04e+3, train_acc=0.502, train_loss=0.693, val_acc=0.497, val_loss=0.696]Epoch 23:   2%|▏         | 23/1000 [20:11:22<821:08:52, 3025.72s/it, lr=0.00025, test_acc=0.515, time=3.01e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 23:   2%|▏         | 24/1000 [20:11:22<819:21:41, 3022.23s/it, lr=0.00025, test_acc=0.515, time=3.01e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 24:   2%|▏         | 24/1000 [20:11:22<819:21:41, 3022.23s/it, lr=0.00025, test_acc=0.515, time=3.01e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 24:   2%|▏         | 24/1000 [21:01:10<819:21:41, 3022.23s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 24:   2%|▎         | 25/1000 [21:01:10<815:42:53, 3011.87s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 25:   2%|▎         | 25/1000 [21:01:10<815:42:53, 3011.87s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 25:   2%|▎         | 25/1000 [21:50:56<815:42:53, 3011.87s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.501, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 25:   3%|▎         | 26/1000 [21:50:56<812:49:55, 3004.31s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.501, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 26:   3%|▎         | 26/1000 [21:50:56<812:49:55, 3004.31s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.501, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 26:   3%|▎         | 26/1000 [22:40:44<812:49:55, 3004.31s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 26:   3%|▎         | 27/1000 [22:40:44<810:38:05, 2999.27s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 27:   3%|▎         | 27/1000 [22:40:44<810:38:05, 2999.27s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 27:   3%|▎         | 27/1000 [23:30:30<810:38:05, 2999.27s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 27:   3%|▎         | 28/1000 [23:30:30<808:45:19, 2995.39s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 28:   3%|▎         | 28/1000 [23:30:30<808:45:19, 2995.39s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 28:   3%|▎         | 28/1000 [24:20:17<808:45:19, 2995.39s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]Epoch 28:   3%|▎         | 28/1000 [24:20:17<844:52:50, 3129.19s/it, lr=0.00025, test_acc=0.515, time=2.99e+3, train_acc=0.503, train_loss=0.693, val_acc=0.497, val_loss=0.693]
Epoch 00021: reducing learning rate of group 0 to 2.5000e-04.
-----------------------------------------------------------------------------------------
Max_time for training elapsed 24.00 hours, so stopping
Test Accuracy: 0.5147
Train Accuracy: 0.5026
Convergence Time (Epochs): 28.0000
TOTAL TIME TAKEN: 89019.1188s
AVG TIME PER EPOCH: 3021.2424s
