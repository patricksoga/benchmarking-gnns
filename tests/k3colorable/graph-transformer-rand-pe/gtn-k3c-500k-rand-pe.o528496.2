/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py:388: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  num_classes = len(np.unique(np.array(dataset.train[:][1])))
/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py:388: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  num_classes = len(np.unique(np.array(dataset.train[:][1])))
cuda available with GPU: NVIDIA TITAN X (Pascal)
[I] Loading dataset K3Colorable...
train, test, val sizes : 7000 1500 1500
[I] Finished loading.
[I] Data load time: 6.8498s
Using random automata position encoding
MODEL DETAILS:

MODEL/Total parameters: GraphTransformer 550852
Using random positional encoding
Training Graphs:  7000
Validation Graphs:  1500
Test Graphs:  1500
Number of Classes:  2
Using random automata position encoding
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1000 [00:00<?, ?it/s]NaN or Inf found in input tensor.
Epoch 0:   0%|          | 0/1000 [01:41<?, ?it/s, lr=0.0005, test_acc=0.511, time=102, train_acc=0.52, train_loss=0.715, val_acc=0.496, val_loss=nan]Epoch 0:   0%|          | 1/1000 [01:41<28:11:57, 101.62s/it, lr=0.0005, test_acc=0.511, time=102, train_acc=0.52, train_loss=0.715, val_acc=0.496, val_loss=nan]Epoch 1:   0%|          | 1/1000 [01:41<28:11:57, 101.62s/it, lr=0.0005, test_acc=0.511, time=102, train_acc=0.52, train_loss=0.715, val_acc=0.496, val_loss=nan]Epoch 1:   0%|          | 1/1000 [03:19<28:11:57, 101.62s/it, lr=0.0005, test_acc=0.515, time=98.2, train_acc=0.515, train_loss=0.704, val_acc=0.497, val_loss=0.694]Epoch 1:   0%|          | 2/1000 [03:19<27:37:25, 99.64s/it, lr=0.0005, test_acc=0.515, time=98.2, train_acc=0.515, train_loss=0.704, val_acc=0.497, val_loss=0.694] Epoch 2:   0%|          | 2/1000 [03:19<27:37:25, 99.64s/it, lr=0.0005, test_acc=0.515, time=98.2, train_acc=0.515, train_loss=0.704, val_acc=0.497, val_loss=0.694]NaN or Inf found in input tensor.
Epoch 2:   0%|          | 2/1000 [04:59<27:37:25, 99.64s/it, lr=0.0005, test_acc=0.514, time=99.5, train_acc=0.517, train_loss=0.694, val_acc=0.495, val_loss=nan]  Epoch 2:   0%|          | 3/1000 [04:59<27:34:56, 99.60s/it, lr=0.0005, test_acc=0.514, time=99.5, train_acc=0.517, train_loss=0.694, val_acc=0.495, val_loss=nan]Epoch 3:   0%|          | 3/1000 [04:59<27:34:56, 99.60s/it, lr=0.0005, test_acc=0.514, time=99.5, train_acc=0.517, train_loss=0.694, val_acc=0.495, val_loss=nan]Epoch 3:   0%|          | 3/1000 [06:37<27:34:56, 99.60s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.523, train_loss=0.692, val_acc=0.496, val_loss=0.699]Epoch 3:   0%|          | 4/1000 [06:37<27:21:55, 98.91s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.523, train_loss=0.692, val_acc=0.496, val_loss=0.699]Epoch 4:   0%|          | 4/1000 [06:37<27:21:55, 98.91s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.523, train_loss=0.692, val_acc=0.496, val_loss=0.699]Epoch 4:   0%|          | 4/1000 [08:15<27:21:55, 98.91s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.534, train_loss=0.69, val_acc=0.497, val_loss=0.726] Epoch 4:   0%|          | 5/1000 [08:15<27:14:08, 98.54s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.534, train_loss=0.69, val_acc=0.497, val_loss=0.726]Epoch 5:   0%|          | 5/1000 [08:15<27:14:08, 98.54s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.534, train_loss=0.69, val_acc=0.497, val_loss=0.726]NaN or Inf found in input tensor.
Epoch 5:   0%|          | 5/1000 [09:53<27:14:08, 98.54s/it, lr=0.0005, test_acc=0.485, time=98, train_acc=0.531, train_loss=0.691, val_acc=0.506, val_loss=nan]   Epoch 5:   1%|          | 6/1000 [09:53<27:09:30, 98.36s/it, lr=0.0005, test_acc=0.485, time=98, train_acc=0.531, train_loss=0.691, val_acc=0.506, val_loss=nan]Epoch 6:   1%|          | 6/1000 [09:53<27:09:30, 98.36s/it, lr=0.0005, test_acc=0.485, time=98, train_acc=0.531, train_loss=0.691, val_acc=0.506, val_loss=nan]Epoch 6:   1%|          | 6/1000 [11:31<27:09:30, 98.36s/it, lr=0.0005, test_acc=0.515, time=98.7, train_acc=0.529, train_loss=0.69, val_acc=0.497, val_loss=0.696]Epoch 6:   1%|          | 7/1000 [11:31<27:10:04, 98.49s/it, lr=0.0005, test_acc=0.515, time=98.7, train_acc=0.529, train_loss=0.69, val_acc=0.497, val_loss=0.696]Epoch 7:   1%|          | 7/1000 [11:31<27:10:04, 98.49s/it, lr=0.0005, test_acc=0.515, time=98.7, train_acc=0.529, train_loss=0.69, val_acc=0.497, val_loss=0.696]NaN or Inf found in input tensor.
Epoch 7:   1%|          | 7/1000 [13:10<27:10:04, 98.49s/it, lr=0.0005, test_acc=0.537, time=98.5, train_acc=0.526, train_loss=0.689, val_acc=0.538, val_loss=nan] Epoch 7:   1%|          | 8/1000 [13:10<27:08:46, 98.51s/it, lr=0.0005, test_acc=0.537, time=98.5, train_acc=0.526, train_loss=0.689, val_acc=0.538, val_loss=nan]Epoch 8:   1%|          | 8/1000 [13:10<27:08:46, 98.51s/it, lr=0.0005, test_acc=0.537, time=98.5, train_acc=0.526, train_loss=0.689, val_acc=0.538, val_loss=nan]Epoch 8:   1%|          | 8/1000 [14:51<27:08:46, 98.51s/it, lr=0.0005, test_acc=0.515, time=101, train_acc=0.539, train_loss=0.688, val_acc=0.496, val_loss=0.707]Epoch 8:   1%|          | 9/1000 [14:51<27:18:40, 99.21s/it, lr=0.0005, test_acc=0.515, time=101, train_acc=0.539, train_loss=0.688, val_acc=0.496, val_loss=0.707]Epoch 9:   1%|          | 9/1000 [14:51<27:18:40, 99.21s/it, lr=0.0005, test_acc=0.515, time=101, train_acc=0.539, train_loss=0.688, val_acc=0.496, val_loss=0.707]NaN or Inf found in input tensor.
Epoch 9:   1%|          | 9/1000 [16:32<27:18:40, 99.21s/it, lr=0.0005, test_acc=0.514, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=nan]  Epoch 9:   1%|          | 10/1000 [16:32<27:27:32, 99.85s/it, lr=0.0005, test_acc=0.514, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=nan]Epoch 10:   1%|          | 10/1000 [16:32<27:27:32, 99.85s/it, lr=0.0005, test_acc=0.514, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=nan]NaN or Inf found in input tensor.
Epoch 10:   1%|          | 10/1000 [18:13<27:27:32, 99.85s/it, lr=0.0005, test_acc=0.517, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.499, val_loss=nan]Epoch 10:   1%|          | 11/1000 [18:13<27:32:08, 100.23s/it, lr=0.0005, test_acc=0.517, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.499, val_loss=nan]Epoch 11:   1%|          | 11/1000 [18:13<27:32:08, 100.23s/it, lr=0.0005, test_acc=0.517, time=101, train_acc=0.538, train_loss=0.689, val_acc=0.499, val_loss=nan]Epoch 11:   1%|          | 11/1000 [19:52<27:32:08, 100.23s/it, lr=0.0005, test_acc=0.486, time=98.6, train_acc=0.536, train_loss=0.689, val_acc=0.503, val_loss=0.693]Epoch 11:   1%|          | 12/1000 [19:52<27:22:38, 99.76s/it, lr=0.0005, test_acc=0.486, time=98.6, train_acc=0.536, train_loss=0.689, val_acc=0.503, val_loss=0.693] Epoch 12:   1%|          | 12/1000 [19:52<27:22:38, 99.76s/it, lr=0.0005, test_acc=0.486, time=98.6, train_acc=0.536, train_loss=0.689, val_acc=0.503, val_loss=0.693]NaN or Inf found in input tensor.
Epoch 12:   1%|          | 12/1000 [21:30<27:22:38, 99.76s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.538, train_loss=0.688, val_acc=0.501, val_loss=nan]  Epoch 12:   1%|▏         | 13/1000 [21:30<27:11:33, 99.18s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.538, train_loss=0.688, val_acc=0.501, val_loss=nan]Epoch 13:   1%|▏         | 13/1000 [21:30<27:11:33, 99.18s/it, lr=0.0005, test_acc=0.515, time=97.8, train_acc=0.538, train_loss=0.688, val_acc=0.501, val_loss=nan]Epoch 13:   1%|▏         | 13/1000 [23:08<27:11:33, 99.18s/it, lr=0.0005, test_acc=0.514, time=98.1, train_acc=0.541, train_loss=0.688, val_acc=0.496, val_loss=0.696]Epoch 13:   1%|▏         | 14/1000 [23:08<27:04:43, 98.87s/it, lr=0.0005, test_acc=0.514, time=98.1, train_acc=0.541, train_loss=0.688, val_acc=0.496, val_loss=0.696]Epoch 14:   1%|▏         | 14/1000 [23:08<27:04:43, 98.87s/it, lr=0.0005, test_acc=0.514, time=98.1, train_acc=0.541, train_loss=0.688, val_acc=0.496, val_loss=0.696]NaN or Inf found in input tensor.
Epoch 14:   1%|▏         | 14/1000 [24:46<27:04:43, 98.87s/it, lr=0.0005, test_acc=0.515, time=98.5, train_acc=0.528, train_loss=0.691, val_acc=0.497, val_loss=nan]  Epoch 14:   2%|▏         | 15/1000 [24:46<27:01:35, 98.78s/it, lr=0.0005, test_acc=0.515, time=98.5, train_acc=0.528, train_loss=0.691, val_acc=0.497, val_loss=nan]Epoch 15:   2%|▏         | 15/1000 [24:46<27:01:35, 98.78s/it, lr=0.0005, test_acc=0.515, time=98.5, train_acc=0.528, train_loss=0.691, val_acc=0.497, val_loss=nan]Epoch 15:   2%|▏         | 15/1000 [26:24<27:01:35, 98.78s/it, lr=0.0005, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.695]Epoch 15:   2%|▏         | 16/1000 [26:24<26:54:29, 98.44s/it, lr=0.0005, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.695]Epoch 16:   2%|▏         | 16/1000 [26:24<26:54:29, 98.44s/it, lr=0.0005, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.695]NaN or Inf found in input tensor.
Epoch 16:   2%|▏         | 16/1000 [28:03<26:54:29, 98.44s/it, lr=0.0005, test_acc=0.514, time=98.5, train_acc=0.538, train_loss=0.688, val_acc=0.495, val_loss=nan]  Epoch 16:   2%|▏         | 17/1000 [28:03<26:53:29, 98.48s/it, lr=0.0005, test_acc=0.514, time=98.5, train_acc=0.538, train_loss=0.688, val_acc=0.495, val_loss=nan]Epoch 17:   2%|▏         | 17/1000 [28:03<26:53:29, 98.48s/it, lr=0.0005, test_acc=0.514, time=98.5, train_acc=0.538, train_loss=0.688, val_acc=0.495, val_loss=nan]NaN or Inf found in input tensor.
Epoch 17:   2%|▏         | 17/1000 [29:41<26:53:29, 98.48s/it, lr=0.0005, test_acc=0.513, time=98.6, train_acc=0.543, train_loss=0.687, val_acc=0.502, val_loss=nan]Epoch 17:   2%|▏         | 18/1000 [29:41<26:52:23, 98.52s/it, lr=0.0005, test_acc=0.513, time=98.6, train_acc=0.543, train_loss=0.687, val_acc=0.502, val_loss=nan]Epoch 18:   2%|▏         | 18/1000 [29:41<26:52:23, 98.52s/it, lr=0.0005, test_acc=0.513, time=98.6, train_acc=0.543, train_loss=0.687, val_acc=0.502, val_loss=nan]NaN or Inf found in input tensor.
Epoch 18:   2%|▏         | 18/1000 [31:19<26:52:23, 98.52s/it, lr=0.0005, test_acc=0.514, time=97.9, train_acc=0.543, train_loss=0.686, val_acc=0.496, val_loss=nan]Epoch 18:   2%|▏         | 19/1000 [31:19<26:47:55, 98.34s/it, lr=0.0005, test_acc=0.514, time=97.9, train_acc=0.543, train_loss=0.686, val_acc=0.496, val_loss=nan]Epoch 19:   2%|▏         | 19/1000 [31:19<26:47:55, 98.34s/it, lr=0.0005, test_acc=0.514, time=97.9, train_acc=0.543, train_loss=0.686, val_acc=0.496, val_loss=nan]Epoch 19:   2%|▏         | 19/1000 [32:56<26:47:55, 98.34s/it, lr=0.0005, test_acc=0.515, time=97.2, train_acc=0.541, train_loss=0.687, val_acc=0.497, val_loss=0.696]Epoch 19:   2%|▏         | 20/1000 [32:56<26:41:00, 98.02s/it, lr=0.0005, test_acc=0.515, time=97.2, train_acc=0.541, train_loss=0.687, val_acc=0.497, val_loss=0.696]Epoch 20:   2%|▏         | 20/1000 [32:56<26:41:00, 98.02s/it, lr=0.0005, test_acc=0.515, time=97.2, train_acc=0.541, train_loss=0.687, val_acc=0.497, val_loss=0.696]Epoch 20:   2%|▏         | 20/1000 [34:33<26:41:00, 98.02s/it, lr=0.0005, test_acc=0.515, time=96.2, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.693]Epoch 20:   2%|▏         | 21/1000 [34:33<26:30:29, 97.48s/it, lr=0.0005, test_acc=0.515, time=96.2, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.693]Epoch 21:   2%|▏         | 21/1000 [34:33<26:30:29, 97.48s/it, lr=0.0005, test_acc=0.515, time=96.2, train_acc=0.538, train_loss=0.689, val_acc=0.497, val_loss=0.693]NaN or Inf found in input tensor.
Epoch 21:   2%|▏         | 21/1000 [36:08<26:30:29, 97.48s/it, lr=0.0005, test_acc=0.53, time=95.4, train_acc=0.541, train_loss=0.688, val_acc=0.519, val_loss=nan]   Epoch 21:   2%|▏         | 22/1000 [36:08<26:19:02, 96.87s/it, lr=0.0005, test_acc=0.53, time=95.4, train_acc=0.541, train_loss=0.688, val_acc=0.519, val_loss=nan]Epoch 22:   2%|▏         | 22/1000 [36:08<26:19:02, 96.87s/it, lr=0.0005, test_acc=0.53, time=95.4, train_acc=0.541, train_loss=0.688, val_acc=0.519, val_loss=nan]NaN or Inf found in input tensor.
Epoch 22:   2%|▏         | 22/1000 [37:44<26:19:02, 96.87s/it, lr=0.0005, test_acc=0.546, time=95.9, train_acc=0.533, train_loss=0.69, val_acc=0.533, val_loss=nan]Epoch 22:   2%|▏         | 23/1000 [37:44<26:12:59, 96.60s/it, lr=0.0005, test_acc=0.546, time=95.9, train_acc=0.533, train_loss=0.69, val_acc=0.533, val_loss=nan]Epoch 23:   2%|▏         | 23/1000 [37:44<26:12:59, 96.60s/it, lr=0.0005, test_acc=0.546, time=95.9, train_acc=0.533, train_loss=0.69, val_acc=0.533, val_loss=nan]Epoch 23:   2%|▏         | 23/1000 [39:21<26:12:59, 96.60s/it, lr=0.00025, test_acc=0.515, time=96.6, train_acc=0.543, train_loss=0.687, val_acc=0.497, val_loss=0.7]Epoch 23:   2%|▏         | 24/1000 [39:21<26:11:48, 96.63s/it, lr=0.00025, test_acc=0.515, time=96.6, train_acc=0.543, train_loss=0.687, val_acc=0.497, val_loss=0.7]Epoch 24:   2%|▏         | 24/1000 [39:21<26:11:48, 96.63s/it, lr=0.00025, test_acc=0.515, time=96.6, train_acc=0.543, train_loss=0.687, val_acc=0.497, val_loss=0.7]NaN or Inf found in input tensor.
Epoch 24:   2%|▏         | 24/1000 [40:59<26:11:48, 96.63s/it, lr=0.00025, test_acc=0.515, time=98.4, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=nan]Epoch 24:   2%|▎         | 25/1000 [40:59<26:18:55, 97.16s/it, lr=0.00025, test_acc=0.515, time=98.4, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=nan]Epoch 25:   2%|▎         | 25/1000 [40:59<26:18:55, 97.16s/it, lr=0.00025, test_acc=0.515, time=98.4, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=nan]Epoch 25:   2%|▎         | 25/1000 [42:37<26:18:55, 97.16s/it, lr=0.00025, test_acc=0.515, time=98, train_acc=0.543, train_loss=0.685, val_acc=0.497, val_loss=0.727]Epoch 25:   3%|▎         | 26/1000 [42:37<26:21:19, 97.41s/it, lr=0.00025, test_acc=0.515, time=98, train_acc=0.543, train_loss=0.685, val_acc=0.497, val_loss=0.727]Epoch 26:   3%|▎         | 26/1000 [42:37<26:21:19, 97.41s/it, lr=0.00025, test_acc=0.515, time=98, train_acc=0.543, train_loss=0.685, val_acc=0.497, val_loss=0.727]NaN or Inf found in input tensor.
Epoch 26:   3%|▎         | 26/1000 [44:15<26:21:19, 97.41s/it, lr=0.00025, test_acc=0.514, time=98, train_acc=0.542, train_loss=0.685, val_acc=0.496, val_loss=nan]  Epoch 26:   3%|▎         | 27/1000 [44:15<26:22:53, 97.61s/it, lr=0.00025, test_acc=0.514, time=98, train_acc=0.542, train_loss=0.685, val_acc=0.496, val_loss=nan]Epoch 27:   3%|▎         | 27/1000 [44:15<26:22:53, 97.61s/it, lr=0.00025, test_acc=0.514, time=98, train_acc=0.542, train_loss=0.685, val_acc=0.496, val_loss=nan]Epoch 27:   3%|▎         | 27/1000 [45:53<26:22:53, 97.61s/it, lr=0.00025, test_acc=0.485, time=97.8, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=0.711]Epoch 27:   3%|▎         | 28/1000 [45:53<26:22:27, 97.68s/it, lr=0.00025, test_acc=0.485, time=97.8, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=0.711]Epoch 28:   3%|▎         | 28/1000 [45:53<26:22:27, 97.68s/it, lr=0.00025, test_acc=0.485, time=97.8, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=0.711]Epoch 28:   3%|▎         | 28/1000 [47:31<26:22:27, 97.68s/it, lr=0.00025, test_acc=0.515, time=98.1, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=0.695]Epoch 28:   3%|▎         | 29/1000 [47:31<26:22:50, 97.81s/it, lr=0.00025, test_acc=0.515, time=98.1, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=0.695]Epoch 29:   3%|▎         | 29/1000 [47:31<26:22:50, 97.81s/it, lr=0.00025, test_acc=0.515, time=98.1, train_acc=0.544, train_loss=0.685, val_acc=0.497, val_loss=0.695]Epoch 29:   3%|▎         | 29/1000 [49:09<26:22:50, 97.81s/it, lr=0.00025, test_acc=0.514, time=97.5, train_acc=0.544, train_loss=0.686, val_acc=0.496, val_loss=0.696]Epoch 29:   3%|▎         | 30/1000 [49:09<26:19:45, 97.72s/it, lr=0.00025, test_acc=0.514, time=97.5, train_acc=0.544, train_loss=0.686, val_acc=0.496, val_loss=0.696]Epoch 30:   3%|▎         | 30/1000 [49:09<26:19:45, 97.72s/it, lr=0.00025, test_acc=0.514, time=97.5, train_acc=0.544, train_loss=0.686, val_acc=0.496, val_loss=0.696]Epoch 30:   3%|▎         | 30/1000 [50:46<26:19:45, 97.72s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.687, val_acc=0.495, val_loss=0.718]Epoch 30:   3%|▎         | 31/1000 [50:46<26:17:37, 97.69s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.687, val_acc=0.495, val_loss=0.718]Epoch 31:   3%|▎         | 31/1000 [50:46<26:17:37, 97.69s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.538, train_loss=0.687, val_acc=0.495, val_loss=0.718]Epoch 31:   3%|▎         | 31/1000 [52:24<26:17:37, 97.69s/it, lr=0.00025, test_acc=0.48, time=97.7, train_acc=0.543, train_loss=0.684, val_acc=0.5, val_loss=0.693]   Epoch 31:   3%|▎         | 32/1000 [52:24<26:16:18, 97.71s/it, lr=0.00025, test_acc=0.48, time=97.7, train_acc=0.543, train_loss=0.684, val_acc=0.5, val_loss=0.693]Epoch 32:   3%|▎         | 32/1000 [52:24<26:16:18, 97.71s/it, lr=0.00025, test_acc=0.48, time=97.7, train_acc=0.543, train_loss=0.684, val_acc=0.5, val_loss=0.693]Epoch 32:   3%|▎         | 32/1000 [54:02<26:16:18, 97.71s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.543, train_loss=0.684, val_acc=0.496, val_loss=0.706]Epoch 32:   3%|▎         | 33/1000 [54:02<26:14:19, 97.68s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.543, train_loss=0.684, val_acc=0.496, val_loss=0.706]Epoch 33:   3%|▎         | 33/1000 [54:02<26:14:19, 97.68s/it, lr=0.00025, test_acc=0.515, time=97.6, train_acc=0.543, train_loss=0.684, val_acc=0.496, val_loss=0.706]NaN or Inf found in input tensor.
Epoch 33:   3%|▎         | 33/1000 [55:39<26:14:19, 97.68s/it, lr=0.00025, test_acc=0.519, time=97.5, train_acc=0.55, train_loss=0.684, val_acc=0.504, val_loss=nan]   Epoch 33:   3%|▎         | 34/1000 [55:39<26:12:03, 97.64s/it, lr=0.00025, test_acc=0.519, time=97.5, train_acc=0.55, train_loss=0.684, val_acc=0.504, val_loss=nan]Epoch 34:   3%|▎         | 34/1000 [55:39<26:12:03, 97.64s/it, lr=0.00025, test_acc=0.519, time=97.5, train_acc=0.55, train_loss=0.684, val_acc=0.504, val_loss=nan]Epoch 34:   3%|▎         | 34/1000 [57:16<26:12:03, 97.64s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.536, train_loss=0.686, val_acc=0.497, val_loss=0.694]Epoch 34:   4%|▎         | 35/1000 [57:16<26:08:37, 97.53s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.536, train_loss=0.686, val_acc=0.497, val_loss=0.694]Epoch 35:   4%|▎         | 35/1000 [57:16<26:08:37, 97.53s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.536, train_loss=0.686, val_acc=0.497, val_loss=0.694]Epoch 35:   4%|▎         | 35/1000 [58:54<26:08:37, 97.53s/it, lr=0.000125, test_acc=0.515, time=97.5, train_acc=0.545, train_loss=0.684, val_acc=0.496, val_loss=0.706]Epoch 35:   4%|▎         | 36/1000 [58:54<26:07:07, 97.54s/it, lr=0.000125, test_acc=0.515, time=97.5, train_acc=0.545, train_loss=0.684, val_acc=0.496, val_loss=0.706]Epoch 36:   4%|▎         | 36/1000 [58:54<26:07:07, 97.54s/it, lr=0.000125, test_acc=0.515, time=97.5, train_acc=0.545, train_loss=0.684, val_acc=0.496, val_loss=0.706]NaN or Inf found in input tensor.
Epoch 36:   4%|▎         | 36/1000 [1:00:31<26:07:07, 97.54s/it, lr=0.000125, test_acc=0.485, time=97.3, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=nan]Epoch 36:   4%|▎         | 37/1000 [1:00:31<26:04:25, 97.47s/it, lr=0.000125, test_acc=0.485, time=97.3, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=nan]Epoch 37:   4%|▎         | 37/1000 [1:00:31<26:04:25, 97.47s/it, lr=0.000125, test_acc=0.485, time=97.3, train_acc=0.542, train_loss=0.685, val_acc=0.503, val_loss=nan]Epoch 37:   4%|▎         | 37/1000 [1:02:09<26:04:25, 97.47s/it, lr=0.000125, test_acc=0.515, time=97.1, train_acc=0.541, train_loss=0.685, val_acc=0.497, val_loss=0.694]Epoch 37:   4%|▍         | 38/1000 [1:02:09<26:01:23, 97.38s/it, lr=0.000125, test_acc=0.515, time=97.1, train_acc=0.541, train_loss=0.685, val_acc=0.497, val_loss=0.694]Epoch 38:   4%|▍         | 38/1000 [1:02:09<26:01:23, 97.38s/it, lr=0.000125, test_acc=0.515, time=97.1, train_acc=0.541, train_loss=0.685, val_acc=0.497, val_loss=0.694]Epoch 38:   4%|▍         | 38/1000 [1:03:46<26:01:23, 97.38s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.548, train_loss=0.683, val_acc=0.497, val_loss=0.696]Epoch 38:   4%|▍         | 39/1000 [1:03:46<25:58:52, 97.33s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.548, train_loss=0.683, val_acc=0.497, val_loss=0.696]Epoch 39:   4%|▍         | 39/1000 [1:03:46<25:58:52, 97.33s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.548, train_loss=0.683, val_acc=0.497, val_loss=0.696]Epoch 39:   4%|▍         | 39/1000 [1:05:23<25:58:52, 97.33s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.547, train_loss=0.682, val_acc=0.497, val_loss=0.704]Epoch 39:   4%|▍         | 40/1000 [1:05:23<25:57:02, 97.32s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.547, train_loss=0.682, val_acc=0.497, val_loss=0.704]Epoch 40:   4%|▍         | 40/1000 [1:05:23<25:57:02, 97.32s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.547, train_loss=0.682, val_acc=0.497, val_loss=0.704]Epoch 40:   4%|▍         | 40/1000 [1:05:39<26:15:53, 98.49s/it, lr=0.000125, test_acc=0.515, time=97.2, train_acc=0.547, train_loss=0.682, val_acc=0.497, val_loss=0.704]
Epoch 00023: reducing learning rate of group 0 to 2.5000e-04.
Epoch 00034: reducing learning rate of group 0 to 1.2500e-04.
Traceback (most recent call last):
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/train/train_K3Colorable_graph_classification.py", line 27, in train_epoch_sparse
    batch_pos_enc = batch_graphs.ndata['pos_enc'].to(device)
  File "/afs/crc.nd.edu/user/p/psoga/.conda/envs/gnn/lib/python3.10/site-packages/dgl/view.py", line 67, in __getitem__
    return self._graph._get_n_repr(self._ntid, self._nodes)[key]
  File "/afs/crc.nd.edu/user/p/psoga/.conda/envs/gnn/lib/python3.10/site-packages/dgl/frame.py", line 523, in __getitem__
    return self._columns[name].data
KeyError: 'pos_enc'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py", line 425, in <module>
    main()    
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py", line 420, in main
    train_val_pipeline(MODEL_NAME, dataset, params, net_params, dirs)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/main_K3Colorable_graph_classification.py", line 162, in train_val_pipeline
    epoch_train_loss, epoch_train_acc, optimizer = train_epoch(model, optimizer, device, train_loader, epoch)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/train/train_K3Colorable_graph_classification.py", line 33, in train_epoch_sparse
    batch_scores = model.forward(batch_graphs, batch_x, batch_e)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/nets/K3Colorable_graph_classification/graph_transformer.py", line 50, in forward
    h = self.pe_layer(g, h, pos_enc)
  File "/afs/crc.nd.edu/user/p/psoga/.conda/envs/gnn/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/afs/crc.nd.edu/user/p/psoga/benchmarking-gnns/layers/pe_layer.py", line 57, in forward
    encs = torch.linalg.solve(B, vec_init)
torch._C._LinAlgError: linalg.solve: The diagonal element 2610 is zero, the solve could not be completed because the input matrix is singular.
